{% if metadata.sidebar.title %}
  <div class="title">
    <div class="toc">
      <ol class="toc-list">
        <li class="toc-item">
          <a class="toc-link is-active-link" href="#">
            {{ metadata.sidebar.title }}
          </a>
        </li>
      </ol>
    </div>
  </div>
{% endif %}

{% if metadata.sidebar.status %}
  <div class="status">
    <iframe
      src="https://ghbtns.com/github-btn.html?user={{ metadata.sidebar.status.user }}&amp;repo={{ metadata.sidebar.status.repo }}&amp;type={{ metadata.sidebar.status.type }}&amp;count=true&amp;size=large"
      width="160px"
      height="30px"
      title="GitHub"
    >
    </iframe>
  </div>
{% endif %}

{% if metadata.sidebar.reference %}
  <div class="reference">
    <div class="toc">
      <ol class="toc-list">
        {% for link in metadata.sidebar.reference.links %}
          <li class="toc-item">
            <a class="toc-link" href="{{ link.path }}" {% if link.path.startswith('http') %}target="_blank"{% endif %}>
              {{ link.name }}
            </a>
          </li>
        {% endfor %}
      </ol>
    </div>
  </div>
{% endif %}

<div class="navigation">
  <div class="js-toc toc"></div>
</div>

<style>
#livemark-sidebar {
  display: none;
  width: 200px;
  position: fixed;
  padding: 10px;
  left: 25px;
  top: 25px;
  font-size: 125%;
}

@media only screen and (min-width: 768px) {
  #livemark-sidebar {
    display: block;
  }
}

#livemark-sidebar .title {
  border-bottom: 1px solid #eaecef;
  padding-bottom: 10px;
  margin-bottom: 16px;
}

#livemark-sidebar .title .toc {
  opacity: 0.5;
}

#livemark-sidebar .status {
  border-bottom: 1px solid #eaecef;
  padding-bottom: 8px;
  margin-bottom: 16px;
}

#livemark-sidebar .status iframe {
  opacity: 0.5;
  border: none;
}

#livemark-sidebar .reference {
  border-bottom: 1px solid #eaecef;
  padding-bottom: 10px;
  margin-bottom: 16px;
}

#livemark-sidebar .reference .toc {
  opacity: 0.5;
}

#livemark-sidebar .reference a[target="_blank"]:hover {
  color: orange;
}

#livemark-sidebar .reference a[target="_blank"]:after {
  content: url('https://i.imgur.com/2ubF3wR.png');
}

#livemark-sidebar .navigation .toc {
  opacity: 0.5;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function () {
  function makeIds() {
    var content = document.querySelector("#livemark-content");
    var headings = content.querySelectorAll("h1, h2, h3, h4, h5, h6, h7");
    var headingMap = {};

    Array.prototype.forEach.call(headings, function (heading) {
      var id = heading.id
        ? heading.id
        : heading.textContent
            .trim()
            .toLowerCase()
            .split(" ")
            .join("-")
            .replace(/[!@#$%^&*():]/gi, "")
            .replace(/\//gi, "-");
      headingMap[id] = !isNaN(headingMap[id]) ? ++headingMap[id] : 0;
      if (headingMap[id]) {
        heading.id = id + "-" + headingMap[id];
      } else {
        heading.id = id;
      }
    });
  }
  makeIds();
  tocbot.init({
    // Where to render the table of contents.
    tocSelector: ".js-toc",
    // Where to grab the headings to build the table of contents.
    contentSelector: "#livemark-content",
    // Which headings to grab inside of the contentSelector element.
    {% if metadata.sidebar.navigation.selector %}
      headingSelector: "{{ metadata.sidebar.navigation.selector }}",
    {% else %}
      headingSelector: "{{ h2, h2, h4 }}",
    {% endif %}
    // For headings inside relative or absolute positioned containers within content.
    hasInnerContainers: true,
  });
});
</script>
